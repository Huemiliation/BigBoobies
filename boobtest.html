<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Memories</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        script: ['"Great Vibes"', 'cursive'],
                        sans: ['"Montserrat"', 'sans-serif'],
                    },
                    colors: {
                        glass: "rgba(255, 255, 255, 0.05)",
                    },
                    animation: {
                        'breathe': 'breathe 3s ease-in-out infinite',
                        'star-fade': 'starFade 1s ease-out forwards',
                    },
                    keyframes: {
                        breathe: {
                            '0%, 100%': { boxShadow: '0 0 15px rgba(255,255,255,0.1)', transform: 'scale(1)' },
                            '50%': { boxShadow: '0 0 30px rgba(255,255,255,0.4)', transform: 'scale(1.02)' },
                        },
                        starFade: {
                            '0%': { opacity: 1, transform: 'scale(1) rotate(0deg)' },
                            '100%': { opacity: 0, transform: 'scale(0) rotate(180deg)' },
                        }
                    }
                }
            }
        }
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Base Styles */
        body { 
            overflow-x: hidden; 
            background-color: #000;
        }
        
        /* Loading Screen */
        #initial-loader {
            position: fixed; inset: 0; z-index: 9999;
            background: #000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s ease;
        }
        .loader-heart {
            width: 50px; height: 50px; background: #fff;
            transform: rotate(45deg);
            animation: heartPulse 1.5s infinite;
        }
        .loader-heart::before, .loader-heart::after {
            content: ""; position: absolute; width: 50px; height: 50px;
            border-radius: 50%; background: #fff;
        }
        .loader-heart::before { left: -25px; }
        .loader-heart::after { top: -25px; }
        @keyframes heartPulse { 0% { transform: rotate(45deg) scale(0.8); opacity: 0.8; } 50% { transform: rotate(45deg) scale(1); opacity: 1; } 100% { transform: rotate(45deg) scale(0.8); opacity: 0.8; } }

        .loader-text {
            margin-top: 40px;
            color: rgba(255,255,255,0.5);
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Particle System */
        .heart-particle {
            position: fixed; pointer-events: none; z-index: 1;
            will-change: transform, opacity;
        }

        /* Utility Classes */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .liquid-glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4);
        }

        /* Special Effects */
        .effect-birthday {
            background: rgba(255, 192, 203, 0.05);
            border: 1px solid rgba(255, 105, 180, 0.4);
            box-shadow: 0 0 25px rgba(255, 105, 180, 0.2);
            animation: breathe 4s infinite;
        }
        .effect-anniversary {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
            animation: breathe 3s infinite;
        }

        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-end infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>

    <div id="initial-loader">
        <div class="loader-heart"></div>
        <div class="loader-text" id="loader-msg">Refresh if you've waited a while</div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { motion, AnimatePresence } = window.Motion;

        // --- Data ---
        const generatePhotos = (seed, context, count = 5) => {
            return Array.from({ length: count }, (_, i) => ({
                id: `${seed}-${i}`,
                src: `https://picsum.photos/seed/${seed * (i + 1)}/600/800`, 
                note: `Memory #${i + 1} from ${context}. We were here, in this moment, and time seemed to stop. It was absolutely perfect.`
            }));
        };

        const CHAPTERS = [
            {
                id: 1,
                title: "Chapter 1",
                subtitle: "Unknowing & Joy",
                // Transition: Deep Cool Blue to Midnight
                theme: { from: "#0f172a", to: "#172554", accent: "#38bdf8" }, 
                song: { 
                    title: "a Vivid dream", 
                    url: "https://huemiliation.github.io/BigBoobies/08%20Radiohead%20-%20Separator.mp3" 
                },
                albums: [
                    { title: "First Glances", date: "Jan 15", photos: generatePhotos(101, "First Glances") },
                    { title: "Her Birthday", date: "March 20", type: "birthday", photos: generatePhotos(102, "Her Birthday") },
                    { title: "First Laughs", date: "April 02", photos: generatePhotos(103, "First Laughs") },
                    { title: "Nervous Hands", date: "May 10", photos: generatePhotos(104, "Nervous Hands") },
                    { title: "Pure Joy", date: "June 22", photos: generatePhotos(105, "Pure Joy") }
                ]
            },
            {
                id: 2,
                title: "Chapter 2",
                subtitle: "Golden Hour",
                // Transition: Warm Browns/Gold
                theme: { from: "#271a0c", to: "#451a03", accent: "#fbbf24" }, 
                song: { 
                    title: "I'll follow to the edge", 
                    url: "https://huemiliation.github.io/BigBoobies/04%20Radiohead%20-%20Weird%20Fishes_%20Arpeggi.mp3" 
                },
                albums: [
                    { title: "Sunsets", date: "July 04", photos: generatePhotos(201, "Sunsets") },
                    { title: "His Birthday", date: "August 12", type: "birthday", photos: generatePhotos(202, "His Birthday") },
                    { title: "Warm Nights", date: "Sept 01", photos: generatePhotos(203, "Warm Nights") },
                    { title: "Golden Light", date: "Oct 15", photos: generatePhotos(204, "Golden Light") },
                    { title: "Deep Talks", date: "Nov 20", photos: generatePhotos(205, "Deep Talks") }
                ]
            },
            {
                id: 3,
                title: "Chapter 3",
                subtitle: "Blood & Forever",
                // Transition: Deep Magenta/Black
                theme: { from: "#2a0a0a", to: "#000000", accent: "#f43f5e" }, 
                song: { 
                    title: "to see you in the next life", 
                    url: "https://raw.githubusercontent.com/Huemiliation/BigBoobies/main/10%20Radiohead%20-%20Motion%20Picture%20Soundtrack.mp3" 
                },
                albums: [
                    { title: "The Bond", date: "Dec 05", photos: generatePhotos(301, "The Bond") },
                    { title: "Intensity", date: "Dec 25", photos: generatePhotos(302, "Intensity") },
                    { title: "1st Anniversary", date: "Feb 14", type: "anniversary", photos: generatePhotos(303, "Our Anniversary", 8) },
                    { title: "Next Life", date: "Future", photos: generatePhotos(304, "Next Life") },
                    { title: "Always", date: "Forever", photos: generatePhotos(305, "Always") }
                ]
            }
        ];

        // --- Helper Components ---

        // 1. Dynamic Particle System
        const ParticleSystem = ({ activeChapter }) => {
            useEffect(() => {
                const container = document.getElementById('particle-container');
                
                // Config based on chapter
                let spawnRate = 2000; // Slow
                let colors = ['#ffffff']; 
                let opacity = 0.3;

                if (activeChapter === 1) {
                    spawnRate = 800; // Faster
                    colors = ['#ffffff', '#fff5d0'];
                    opacity = 0.5;
                } else if (activeChapter === 2) {
                    spawnRate = 200; // Intense
                    colors = ['#ffffff', '#ff00ff', '#f43f5e']; // White + Magenta
                    opacity = 0.7;
                }

                const spawnHeart = () => {
                    if (document.hidden) return;
                    const h = document.createElement('div');
                    h.className = 'heart-particle';
                    const size = Math.random() * 15 + 10;
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    
                    // Styles
                    h.style.width = `${size}px`;
                    h.style.height = `${size}px`;
                    h.style.background = color;
                    h.style.left = Math.random() * 100 + 'vw';
                    h.style.bottom = '-50px';
                    h.style.opacity = '0';
                    h.style.transform = 'rotate(45deg)';
                    
                    // CSS Shape
                    h.innerHTML = `
                        <div style="position:absolute; width:100%; height:100%; background:inherit; border-radius:50%; top:-50%; left:0;"></div>
                        <div style="position:absolute; width:100%; height:100%; background:inherit; border-radius:50%; top:0; left:-50%;"></div>
                    `;
                    
                    container.appendChild(h);

                    // Animate
                    const anim = h.animate([
                        { transform: 'translateY(0) rotate(45deg) scale(0)', opacity: 0 },
                        { opacity: opacity, offset: 0.2 },
                        { transform: `translateY(-${80 + Math.random()*20}vh) rotate(90deg) scale(1)`, opacity: 0 }
                    ], {
                        duration: 5000 + Math.random() * 5000,
                        easing: 'linear'
                    });

                    anim.onfinish = () => h.remove();
                };

                const intervalId = setInterval(spawnHeart, spawnRate);
                return () => clearInterval(intervalId);
            }, [activeChapter]);

            return <div id="particle-container" className="fixed inset-0 pointer-events-none z-0"></div>;
        };

        // 2. Typewriter
        const Typewriter = ({ text, delay = 0, speed = 50, className = "" }) => {
            const [displayed, setDisplayed] = useState("");
            useEffect(() => {
                setDisplayed(""); 
                const timeout = setTimeout(() => {
                    let i = 0;
                    const interval = setInterval(() => {
                        if (i < text.length) {
                            setDisplayed((prev) => prev + text.charAt(i));
                            i++;
                        } else {
                            clearInterval(interval);
                        }
                    }, speed);
                    return () => clearInterval(interval);
                }, delay);
                return () => clearTimeout(timeout);
            }, [text, delay, speed]);
            return <span className={`${className} typing-cursor`}>{displayed}</span>;
        };

        // 3. Inline Music Button
        const InlineMusicButton = ({ song, accent, activeSong, onToggle }) => {
            const isActive = activeSong === song.url;
            return (
                <div className="flex justify-center my-8 h-16">
                     <motion.button 
                        className={`relative rounded-full flex items-center justify-center liquid-glass cursor-pointer transition-all duration-500 overflow-hidden px-8 py-4`}
                        initial={false}
                        whileHover={{ scale: 1.05 }}
                        whileTap={{ scale: 0.95 }}
                        animate={{ 
                            backgroundColor: isActive ? 'rgba(255,255,255,0.1)' : 'rgba(255,255,255,0.02)',
                            borderColor: isActive ? accent : 'rgba(255,255,255,0.1)'
                        }}
                        onClick={() => onToggle(song.url)}
                    >
                        {!isActive && (
                            <div className="absolute inset-0 animate-breathe opacity-50 bg-white/5"></div>
                        )}
                        <span className="font-sans font-bold uppercase tracking-widest text-xs md:text-sm text-white whitespace-nowrap z-10">
                            {isActive ? 'Playing...' : song.title}
                        </span>
                    </motion.button>
                </div>
            )
        };

        // 4. Sticky Bottom Player
        const StickyPlayer = ({ activeSong, accent, songTitle, onToggle, audioRef }) => {
            if (!activeSong) return null;
            
            const [progress, setProgress] = useState(0);

            useEffect(() => {
                const update = () => {
                    const audio = audioRef.current;
                    if(audio) setProgress((audio.currentTime / audio.duration) * 100 || 0);
                };
                const interval = setInterval(update, 500);
                return () => clearInterval(interval);
            }, [activeSong]);

            return (
                <motion.div 
                    initial={{ y: 100, opacity: 0 }}
                    animate={{ y: 0, opacity: 1 }}
                    exit={{ scale: 0, opacity: 0, rotate: 180 }}
                    transition={{ type: "spring", stiffness: 260, damping: 20 }}
                    className="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-md liquid-glass rounded-2xl p-4 flex items-center gap-4 border border-white/20 backdrop-blur-xl shadow-2xl"
                    style={{ borderColor: accent }}
                >
                    <button onClick={() => onToggle(activeSong)} className="p-3 bg-white/10 rounded-full hover:bg-white/20 transition-colors">
                        <span className="text-xl">‚è∏</span>
                    </button>
                    
                    <div className="flex-1 overflow-hidden">
                        <div className="text-xs text-gray-400 uppercase tracking-wider mb-1 truncate">{songTitle}</div>
                        <div className="w-full h-1.5 bg-white/10 rounded-full overflow-hidden">
                            <motion.div 
                                className="h-full rounded-full"
                                style={{ backgroundColor: accent, width: `${progress}%` }}
                            />
                        </div>
                    </div>
                </motion.div>
            );
        };

        // 5. Carousel
        const Carousel = ({ photos, onOpen, type }) => {
            const displayPhotos = useMemo(() => [...photos, ...photos, ...photos], [photos]);
            
            const cardClass = type === 'anniversary' 
                ? 'w-[180px] h-[260px] md:w-[220px] md:h-[300px] border-yellow-500/50' 
                : 'w-[140px] h-[200px] md:w-[180px] md:h-[260px] border-white/10';

            return (
                <div className="w-full overflow-hidden relative py-6 group">
                    <div className="absolute left-0 top-0 bottom-0 w-8 z-10 bg-gradient-to-r from-black/50 to-transparent pointer-events-none"></div>
                    <div className="absolute right-0 top-0 bottom-0 w-8 z-10 bg-gradient-to-l from-black/50 to-transparent pointer-events-none"></div>
                    
                    <div className="flex w-max gap-4 md:gap-6 animate-scroll hover:pause-scroll pl-4">
                        {displayPhotos.map((photo, idx) => (
                            <div
                                key={`${photo.id}-${idx}`}
                                className={`relative flex-shrink-0 rounded-xl overflow-hidden cursor-pointer border transition-transform duration-300 hover:scale-105 hover:z-10 shadow-lg ${cardClass}`}
                                onClick={() => onOpen(idx % photos.length)}
                            >
                                <img src={photo.src} alt="memory" loading="lazy" className="w-full h-full object-cover" />
                                <div className="absolute inset-0 bg-black/10 hover:bg-transparent transition-colors"></div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // 6. Lightbox
        const Lightbox = ({ isOpen, albumPhotos, startIndex, onClose, accent }) => {
            if (!isOpen || !albumPhotos) return null;
            const [currentIndex, setCurrentIndex] = useState(startIndex);
            const currentPhoto = albumPhotos[currentIndex];
            const progress = ((currentIndex + 1) / albumPhotos.length) * 100;

            const navigate = (dir) => {
                setCurrentIndex((prev) => (prev + dir + albumPhotos.length) % albumPhotos.length);
            };

            return (
                <motion.div 
                    initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
                    className="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4"
                    onClick={onClose}
                >
                    {/* Fixed X Button Top Right */}
                    <button 
                        onClick={onClose} 
                        className="absolute top-4 right-4 p-3 bg-white/10 rounded-full opacity-70 hover:opacity-100 z-[110]"
                    >
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                    
                    {/* Navigation */}
                    <button onClick={(e) => { e.stopPropagation(); navigate(-1); }} className="absolute left-2 md:left-8 top-1/2 -translate-y-1/2 z-[105] p-4 opacity-60 hover:opacity-100 text-white hover:scale-110 transition-transform">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor" style={{ transform: 'rotate(-90deg)', color: accent }}><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    </button>
                    <button onClick={(e) => { e.stopPropagation(); navigate(1); }} className="absolute right-2 md:right-8 top-1/2 -translate-y-1/2 z-[105] p-4 opacity-60 hover:opacity-100 text-white hover:scale-110 transition-transform">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor" style={{ transform: 'rotate(90deg)', color: accent }}><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    </button>

                    <div className="w-full max-w-5xl h-full flex flex-col md:flex-row items-center justify-center gap-6" onClick={e => e.stopPropagation()}>
                        
                        {/* Image Container */}
                        <div className="relative flex-1 w-full max-h-[70vh] md:max-h-[85vh] flex items-center justify-center">
                            <motion.img 
                                key={currentIndex}
                                initial={{ opacity: 0, scale: 0.95 }}
                                animate={{ opacity: 1, scale: 1 }}
                                src={currentPhoto.src}
                                className="max-w-full max-h-full object-contain rounded-lg shadow-2xl border border-white/10"
                                style={{ boxShadow: `0 0 40px ${accent}20` }}
                            />
                        </div>

                        {/* Info Container (Separate on mobile) */}
                        <div className="w-full md:w-80 flex-shrink-0 flex flex-col gap-4">
                            {/* Counter Bar */}
                            <div className="flex items-center gap-4">
                                <div className="flex-1 h-1 bg-white/10 rounded-full overflow-hidden">
                                    <motion.div className="h-full" style={{ backgroundColor: accent }} initial={{ width: 0 }} animate={{ width: `${progress}%` }} />
                                </div>
                                <span className="text-xs font-sans font-bold text-white/50">{currentIndex + 1}/{albumPhotos.length}</span>
                            </div>

                            {/* Scrollable Note */}
                            <div className="liquid-glass rounded-xl p-4 md:p-6 w-full overflow-x-auto hide-scrollbar scroll-mask-right whitespace-nowrap border-l-2" style={{ borderColor: accent }}>
                                <Typewriter 
                                    text={currentPhoto.note} 
                                    speed={30} 
                                    delay={200}
                                    className="text-gray-200 font-sans text-sm md:text-base font-light tracking-wide inline-block pr-12"
                                />
                            </div>
                        </div>
                    </div>
                </motion.div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [activeChapter, setActiveChapter] = useState(0);
            const [lightboxState, setLightboxState] = useState({ open: false, photos: null, index: 0 });
            const [activeSong, setActiveSong] = useState(null); // stores { url, title }
            const audioRef = useRef(null);

            // Loader Logic
            useEffect(() => {
                // Show text after 5s
                const timer = setTimeout(() => {
                    const text = document.getElementById('loader-msg');
                    if(text) text.style.opacity = '1';
                }, 5000);

                const removeLoader = () => {
                    const loader = document.getElementById('initial-loader');
                    if(loader) {
                        loader.style.opacity = '0';
                        setTimeout(() => loader.remove(), 800);
                    }
                };

                if (document.readyState === 'complete') removeLoader();
                else window.addEventListener('load', removeLoader);
                setTimeout(removeLoader, 8000); // Safety net
                return () => clearTimeout(timer);
            }, []);

            // Audio Logic
            useEffect(() => {
                const audio = audioRef.current;
                if(!audio) return;
                
                const handleEnd = () => setActiveSong(null);
                audio.addEventListener('ended', handleEnd);

                if (activeSong) {
                    audio.src = activeSong.url;
                    audio.play().catch(e => console.error("Play error:", e));
                } else {
                    audio.pause();
                }

                return () => { audio.pause(); audio.removeEventListener('ended', handleEnd); };
            }, [activeSong]);

            // Scroll Theme Logic
            useEffect(() => {
                const handleScroll = () => {
                    const sections = document.querySelectorAll('.chapter-section');
                    sections.forEach((sec, index) => {
                        const rect = sec.getBoundingClientRect();
                        if (rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2) {
                            setActiveChapter(index);
                        }
                    });
                };
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            const currentTheme = CHAPTERS[activeChapter].theme;

            return (
                <div 
                    className="min-h-screen transition-colors ease-in-out" 
                    style={{ 
                        background: `linear-gradient(to bottom, ${currentTheme.from}, ${currentTheme.to})`,
                        transitionDuration: '4000ms' // Smooth long transition
                    }}
                >
                    <ParticleSystem activeChapter={activeChapter} />
                    <audio ref={audioRef} id="global-audio" />

                    <div className="relative z-10 max-w-6xl mx-auto px-4 pb-40">
                        <header className="pt-32 pb-20 text-center animate-fade-in-up">
                            <h1 className="font-script text-6xl sm:text-8xl md:text-9xl mb-6 text-white drop-shadow-2xl">
                                <Typewriter text="Our Memories" speed={150} delay={500} />
                            </h1>
                        </header>

                        {CHAPTERS.map((chapter) => (
                            <section key={chapter.id} className="chapter-section py-20 min-h-[85vh] flex flex-col justify-center">
                                <div className="text-center mb-12">
                                    <h2 className="font-script text-5xl md:text-7xl text-white/90 mb-2 transition-colors duration-1000">{chapter.title}</h2>
                                    <h3 className="font-sans text-sm md:text-lg tracking-[0.3em] uppercase text-white/60 mb-6" style={{ color: currentTheme.accent }}>{chapter.subtitle}</h3>
                                    
                                    {/* Inline Button only plays/pauses logic */}
                                    <InlineMusicButton 
                                        song={chapter.song} 
                                        accent={currentTheme.accent} 
                                        activeSong={activeSong ? activeSong.url : null}
                                        onToggle={(url) => setActiveSong(activeSong && activeSong.url === url ? null : { url, title: chapter.song.title })} 
                                    />
                                </div>

                                <div className="space-y-16 md:space-y-24">
                                    {chapter.albums.map((album, aIdx) => (
                                        <div key={aIdx} className={`
                                            rounded-2xl p-4 md:p-8 transition-all duration-500 hover:bg-white/5
                                            ${album.type === 'birthday' ? 'effect-birthday' : 
                                              album.type === 'anniversary' ? 'effect-anniversary scale-[1.02]' : 'liquid-glass'}
                                        `}>
                                            <div className="flex items-end gap-3 mb-6 ml-2 border-l-4 pl-4" style={{ borderColor: currentTheme.accent }}>
                                                <div>
                                                    <h4 className="font-sans font-bold text-base md:text-lg uppercase tracking-wider text-white/90">{album.title}</h4>
                                                    <span className="font-sans text-[10px] md:text-xs font-light tracking-widest text-white/50">{album.date}</span>
                                                </div>
                                                {album.type === 'birthday' && <span className="text-xl animate-bounce">üéÇ</span>}
                                                {album.type === 'anniversary' && <span className="text-xl animate-pulse">üíñ</span>}
                                            </div>
                                            
                                            <Carousel 
                                                photos={album.photos} 
                                                onOpen={(idx) => setLightboxState({ open: true, photos: album.photos, index: idx })}
                                                type={album.type}
                                            />
                                        </div>
                                    ))}
                                </div>
                            </section>
                        ))}
                    </div>

                    <AnimatePresence>
                        {lightboxState.open && (
                            <Lightbox 
                                isOpen={lightboxState.open} 
                                albumPhotos={lightboxState.photos} 
                                startIndex={lightboxState.index}
                                onClose={() => setLightboxState({ ...lightboxState, open: false })}
                                accent={currentTheme.accent}
                            />
                        )}
                        {/* Sticky Player */}
                        {activeSong && (
                             <StickyPlayer 
                                activeSong={activeSong.url}
                                songTitle={activeSong.title}
                                accent={currentTheme.accent}
                                onToggle={() => setActiveSong(null)}
                                audioRef={audioRef}
                            />
                        )}
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
